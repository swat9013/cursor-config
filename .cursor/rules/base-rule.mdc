---
description:
globs:
alwaysApply: true
---
---
name: "基本ルール"
type: "always"
description: "プロジェクト全体に常に適用される基本的なルールセット。新しいルールの追加プロセスと開発の基本方針を定義"
version: "1.3.0"
author: "AI Assistant"
tags: ["base", "fundamental", "process", "quality", "workflow", "parallel-processing", "document-quality", "task-management"]
trigger_keywords: ["基本ルール", "基本方針", "開発ルール", "base-rule", "並列処理", "並列実行", "ドキュメント品質確認", "ドキュメントチェック", "task.md", "タスク実行", "段階的実行"]
---

# 基本ルール（base-rule.mdc）

## 🔨 最重要ルール - 新しいルールの追加プロセス

**背景**: プロジェクトの成長に伴い、新しい課題や要件が発生します。このプロセスにより、ルールを体系的かつ継続的に改善し、プロジェクトの品質と効率性を向上させます。

**適用条件**: ユーザーから今回限りではなく常に対応が必要だと思われる指示を受けた場合

**実行手順**:
1. 「これを標準のルールにしますか？」とユーザーに質問する
2. YESの回答を得た場合、base-rule.mdcに追加ルールとして記載する
3. 以降は標準ルールとして常に適用する
4. 月次でルールの有効性を評価し、必要に応じて調整する

## 💬 基本的な対応方針

### 1. 言語設定とコミュニケーション
- **言語**: 日本語での対応を基本とする（技術用語は英語併記可）
- **説明レベル**: 技術的な内容も可能な限り日本語で分かりやすく説明する
- **質問方針**: 不明点は積極的に質問し、要件を明確化する

### 2. コード品質基準

#### 2.1 可読性
- **関数サイズ**: 1関数あたり最大50行以内
- **変数名**: 目的が明確に分かる名前を使用（略語禁止、例外：iやjなどの一般的なループ変数）
- **コメント**: 複雑なロジックには必ず日本語コメントを記載

#### 2.2 エラーハンドリング
- すべての外部API呼び出しにはtry-catch文を実装
- エラーメッセージは日本語で具体的な内容を記載
- ログレベル（error, warn, info, debug）を適切に設定

### 3. ファイル管理規約

#### 3.1 ファイル操作の優先順位
1. **最優先**: 既存ファイルの編集
2. **次点**: 既存ディレクトリ内での新規ファイル作成
3. **最終手段**: 新規ディレクトリ作成

#### 3.2 命名規則
- **ファイル名**: kebab-case（例：user-profile.tsx）
- **ディレクトリ名**: kebab-case（例：user-management/）
- **一時ファイル**: 接頭辞「temp-」+ タイムスタンプ

### 4. ドキュメント作成方針

**作成基準**: 以下の場合のみドキュメントファイルを作成
- ユーザーからの明示的な要求がある場合
- 複雑なアーキテクチャの説明が必要な場合
- APIドキュメントなど外部向け資料が必要な場合

**代替手段**: コード内コメント、JSDoc、TypeDocによる説明を優先

#### 4.1 ドキュメント品質確認ルール

**背景**: ドキュメント作成後の品質チェックにより、一貫した品質を保ち、既存ルールとの整合性を確保する。

**適用条件**: ドキュメントファイル（.md、.mdc等）を作成・編集した場合

**実行手順**:
1. **ルール整合性確認**: 作成したドキュメントが既存のルールに準拠しているかを確認

**確認必須項目**:
- [ ] ルールとの整合性確認完了


### 5. 段階的実装アプローチ

#### 5.1 実装フェーズ
1. **要件定義**: 機能要件と非機能要件の明確化
2. **設計**: アーキテクチャ設計と詳細設計
3. **実装**: 段階的な機能実装
4. **テスト**: 単体テスト → 結合テスト → システムテスト
5. **デプロイ**: 段階的リリース

#### 5.2 各段階での確認項目
- 動作確認の実施
- コードレビューの実施
- テストカバレッジの確認（最低80%）

### 6. 並列処理最適化ルール

**背景**: 最大限の効率を追求し、ユーザー体験を向上させるため、独立した処理は可能な限り並列実行する。

**適用条件**: 複数の独立した処理（ファイル読み込み、検索、API呼び出し等）を実行する場合

**実行原則**:
- **並列実行を優先**: 順次実行ではなく、同時実行を基本とする
- **効率性重視**: 3-5倍の高速化を目指す
- **リソース最適化**: システムリソースを最大限活用する

**具体的な適用例**:
- 複数ファイルの読み込み → 全ファイルを並列読み込み
- 複数パターンの検索 → 全検索を同時実行
- 独立したコードベース検索 → 全検索を並列実行
- 複数のAPI呼び出し → 同時リクエスト
- 情報収集フェーズ → 必要な全情報を一度に並列取得

**例外条件**: 前の処理結果が次の処理の入力として必要な場合のみ順次実行

### 7. エラー対応プロトコル

#### 7.1 リンターエラー対応
- **修正条件**: 明確な修正方法が判明している場合のみ
- **修正回数**: 同一ファイルに対して最大3回まで
- **エスカレーション**: 3回を超える場合はユーザーに質問

#### 7.2 実行時エラー対応
- エラーログの詳細確認
- 根本原因の特定
- 修正方法の提案と実装

### 8. task.mdベース作業プロセス

**背景**: task.mdファイルに定義されたタスクを体系的かつ段階的に実行することで、作業品質の向上と進捗の可視化を実現する。

**適用条件**: task.mdファイルに基づいて作業を実行する場合

**実行手順**:
1. **1段階実行**: タスクリストから1つのステップのみを実行する
2. **進捗反映**: 完了したステップの進捗をドキュメント（task.md等）に反映する
3. **コミット実行**: 変更内容を適切なコミットメッセージでコミットする

**進捗反映方法**:
- [ ] 未完了のタスクは空のチェックボックスのまま
- [x] 完了済みのタスクはチェックボックスにxを入れる
- 必要に応じて完了日時や備考を追記

**コミットメッセージ規則**:
- 形式：`[タスク] <完了したステップの概要>`
- 例：`[タスク] データベース設計を完了`
- 例：`[タスク] API実装の第1段階を完了`

**効果**:
- 作業の可視化による進捗管理の改善
- 段階的実行による品質向上
- 変更履歴の明確化によるトレーサビリティ確保

## 🎯 優先順位マトリックス

| 優先度 | カテゴリ | 具体例 | 対応時間目安 |
|:------|:--------|:-------|:------------|
| **最重要** | 新ルール追加プロセス | ルール標準化の判断・実行 | 即時 |
| **最重要** | 並列処理最適化 | 複数独立処理の同時実行 | 即時 |
| **高** | task.mdベース作業 | 段階的実行・進捗反映・コミット | 1ステップ毎 |
| **高** | エラー修正 | リンターエラー、実行時エラー | 30分以内 |
| **中** | コード品質向上 | リファクタリング、最適化 | 1時間以内 |
| **低** | 機能拡張 | 新機能追加、UI改善 | 適宜 |

## 📋 タスク完了チェックリスト

### 基本確認項目
- [ ] **機能実装**: 要求された機能が完全に実装されている
- [ ] **エラー排除**: リンターエラー・実行時エラーが存在しない
- [ ] **コード品質**: 可読性基準（関数50行以内、適切な命名等）を満たしている
- [ ] **テスト**: 必要なテストケースが実装されている
- [ ] **ドキュメント**: コード内コメントが適切に記載されている

### プロセス確認項目
- [ ] **ルール追加**: 新しいルールが必要な場合は追加プロセスを実行
- [ ] **並列処理最適化**: 複数の独立した処理を同時実行している
- [ ] **task.mdベース作業**: ステップ実行→進捗反映→コミットの順序を遵守
- [ ] **ドキュメント品質確認**: ドキュメント作成後、ルール整合性を確認
- [ ] **ファイル管理**: 不要な一時ファイルを削除
- [ ] **バージョン管理**: 適切なコミットメッセージでコミット

### 品質確認項目
- [ ] **パフォーマンス**: 明らかなパフォーマンス問題がない
- [ ] **セキュリティ**: 基本的なセキュリティ対策が実装されている
- [ ] **アクセシビリティ**: UI関連の場合、基本的なアクセシビリティを考慮

## 🔄 継続的改善メカニズム

**改善サイクル**:
1. **月次レビュー**: ルールの有効性と適用状況を評価
2. **課題抽出**: 新たに発生した問題や改善点を特定
3. **ルール更新**: 必要に応じてルールの追加・修正・削除
4. **効果測定**: 改善効果の定量的・定性的評価

**このルール自体も上記プロセスに従って継続的に改善されます。**
